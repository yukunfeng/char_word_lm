Namespace(batch_size=20, bptt=35, clip=0.25, combination=['1', '1', '0.5'], data='/home/lr/yukun/common_corpus/data/50lm/ar', device='cuda:0', dropout=0.5, emsize=650, epochs=40, input_freq=1, log_interval=200, lr=20, max_gram_n=3, model='LSTM', nhid=650, nlayers=2, note='Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2)', onnx_export='', save='char-word-word.en.model', seed=1111, tied=False, use_bilstm=True, weights=[1.0, 1.0, 0.5], word_out_num=1)
max length of word:30
n value in n-gram: 3
/home/lr/yukun/common_corpus/data/50lm/ar Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) total param_num: 151.512M
/home/lr/yukun/common_corpus/data/50lm/ar Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) decoder vocab size: 89093
/home/lr/yukun/common_corpus/data/50lm/ar Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) encoder vocab size: 89093
/home/lr/yukun/common_corpus/data/50lm/ar Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) ngram vocab size: 32638
| end of epoch   1 | time: 98.53s | valid loss  7.88 | valid ppl  2641.77 lr:20.00
| end of epoch   2 | time: 100.16s | valid loss  7.58 | valid ppl  1962.00 lr:20.00
| end of epoch   3 | time: 100.15s | valid loss  7.42 | valid ppl  1665.11 lr:20.00
| end of epoch   4 | time: 100.79s | valid loss  7.28 | valid ppl  1453.40 lr:20.00
| end of epoch   5 | time: 100.31s | valid loss  7.23 | valid ppl  1374.73 lr:20.00
| end of epoch   6 | time: 100.14s | valid loss  7.25 | valid ppl  1402.77 lr:20.00
| end of epoch   7 | time: 100.39s | valid loss  7.08 | valid ppl  1186.84 lr: 5.00
| end of epoch   8 | time: 100.48s | valid loss  7.08 | valid ppl  1184.96 lr: 5.00
| end of epoch   9 | time: 100.35s | valid loss  7.09 | valid ppl  1198.20 lr: 5.00
| end of epoch  10 | time: 100.39s | valid loss  7.05 | valid ppl  1149.28 lr: 1.25
| end of epoch  11 | time: 100.61s | valid loss  7.05 | valid ppl  1147.17 lr: 1.25
| end of epoch  12 | time: 100.40s | valid loss  7.05 | valid ppl  1147.54 lr: 1.25
| end of epoch  13 | time: 100.23s | valid loss  7.03 | valid ppl  1127.83 lr: 0.31
| end of epoch  14 | time: 100.19s | valid loss  7.03 | valid ppl  1127.70 lr: 0.31
| end of epoch  15 | time: 100.73s | valid loss  7.03 | valid ppl  1128.48 lr: 0.31
| end of epoch  16 | time: 100.17s | valid loss  7.02 | valid ppl  1115.55 lr: 0.08
| end of epoch  17 | time: 100.23s | valid loss  7.01 | valid ppl  1112.30 lr: 0.08
| end of epoch  18 | time: 100.08s | valid loss  7.01 | valid ppl  1109.98 lr: 0.08
| end of epoch  19 | time: 100.12s | valid loss  7.01 | valid ppl  1107.58 lr: 0.08
| end of epoch  20 | time: 100.96s | valid loss  7.01 | valid ppl  1106.05 lr: 0.08
| end of epoch  21 | time: 100.75s | valid loss  7.01 | valid ppl  1104.74 lr: 0.08
| end of epoch  22 | time: 100.78s | valid loss  7.01 | valid ppl  1102.45 lr: 0.08
| end of epoch  23 | time: 100.65s | valid loss  7.01 | valid ppl  1102.43 lr: 0.08
| end of epoch  24 | time: 100.71s | valid loss  7.00 | valid ppl  1101.05 lr: 0.08
| end of epoch  25 | time: 100.36s | valid loss  7.00 | valid ppl  1100.45 lr: 0.08
| end of epoch  26 | time: 100.51s | valid loss  7.00 | valid ppl  1100.26 lr: 0.08
| end of epoch  27 | time: 100.19s | valid loss  7.00 | valid ppl  1100.24 lr: 0.08
| end of epoch  28 | time: 100.42s | valid loss  7.00 | valid ppl  1098.61 lr: 0.08
| end of epoch  29 | time: 100.15s | valid loss  7.00 | valid ppl  1098.87 lr: 0.08
all training time elapsed: 0:48:29.959471
training time per epoch: 0:01:12.748987
=========================================================================================
| End of training | test loss  7.07 | best_val_ppl  1098.61 test ppl  1171.95
=========================================================================================
final_out: /home/lr/yukun/common_corpus/data/50lm/ar Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) 1098.6074393291037 1171.9503357033104
1-15, 15-30, 30-45, 45-60, 60-75, 75-90, 90+
[1544.5926051868908, 1257.4040296459243, 1222.2112952437008, 1337.2804889358679, 1168.1695566628923, 791.281734492148, 0]
