Namespace(batch_size=20, bptt=35, clip=0.25, combination=['1', '1', '0.5'], data='/home/lr/yukun/common_corpus/data/50lm/ja', device='cuda:0', dropout=0.5, emsize=650, epochs=40, input_freq=1, log_interval=200, lr=20, max_gram_n=3, model='LSTM', nhid=650, nlayers=2, note='Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2)', onnx_export='', save='char-word-word.en.model', seed=1111, tied=False, use_bilstm=True, weights=[1.0, 1.0, 0.5], word_out_num=1)
max length of word:21
n value in n-gram: 1
/home/lr/yukun/common_corpus/data/50lm/ja Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) total param_num: 75.483M
/home/lr/yukun/common_corpus/data/50lm/ja Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) decoder vocab size: 44867
/home/lr/yukun/common_corpus/data/50lm/ja Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) encoder vocab size: 44867
/home/lr/yukun/common_corpus/data/50lm/ja Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) ngram vocab size: 4189
| end of epoch   1 | time: 67.04s | valid loss  5.43 | valid ppl   227.48 lr:20.00
| end of epoch   2 | time: 67.95s | valid loss  5.11 | valid ppl   165.63 lr:20.00
| end of epoch   3 | time: 68.03s | valid loss  4.98 | valid ppl   144.95 lr:20.00
| end of epoch   4 | time: 67.96s | valid loss  4.86 | valid ppl   128.61 lr:20.00
| end of epoch   5 | time: 67.84s | valid loss  4.80 | valid ppl   121.87 lr:20.00
| end of epoch   6 | time: 67.95s | valid loss  4.79 | valid ppl   119.76 lr:20.00
| end of epoch   7 | time: 67.93s | valid loss  4.73 | valid ppl   113.80 lr:20.00
| end of epoch   8 | time: 67.94s | valid loss  4.74 | valid ppl   114.34 lr:20.00
| end of epoch   9 | time: 67.95s | valid loss  4.65 | valid ppl   104.07 lr: 5.00
| end of epoch  10 | time: 68.04s | valid loss  4.63 | valid ppl   102.04 lr: 5.00
| end of epoch  11 | time: 67.93s | valid loss  4.63 | valid ppl   102.32 lr: 5.00
| end of epoch  12 | time: 68.04s | valid loss  4.60 | valid ppl    99.50 lr: 1.25
| end of epoch  13 | time: 68.02s | valid loss  4.60 | valid ppl    99.24 lr: 1.25
| end of epoch  14 | time: 67.99s | valid loss  4.59 | valid ppl    98.90 lr: 1.25
| end of epoch  15 | time: 67.96s | valid loss  4.59 | valid ppl    98.89 lr: 1.25
| end of epoch  16 | time: 67.91s | valid loss  4.59 | valid ppl    98.84 lr: 1.25
| end of epoch  17 | time: 67.98s | valid loss  4.59 | valid ppl    98.64 lr: 1.25
| end of epoch  18 | time: 68.04s | valid loss  4.60 | valid ppl    99.06 lr: 1.25
| end of epoch  19 | time: 68.14s | valid loss  4.59 | valid ppl    98.20 lr: 0.31
| end of epoch  20 | time: 68.04s | valid loss  4.59 | valid ppl    98.17 lr: 0.31
| end of epoch  21 | time: 68.01s | valid loss  4.59 | valid ppl    98.31 lr: 0.31
| end of epoch  22 | time: 68.17s | valid loss  4.58 | valid ppl    97.60 lr: 0.08
| end of epoch  23 | time: 68.06s | valid loss  4.58 | valid ppl    97.55 lr: 0.08
| end of epoch  24 | time: 68.05s | valid loss  4.58 | valid ppl    97.55 lr: 0.08
| end of epoch  25 | time: 67.94s | valid loss  4.58 | valid ppl    97.55 lr: 0.08
| end of epoch  26 | time: 68.05s | valid loss  4.58 | valid ppl    97.48 lr: 0.08
| end of epoch  27 | time: 68.01s | valid loss  4.58 | valid ppl    97.53 lr: 0.08
all training time elapsed: 0:30:34.996443
training time per epoch: 0:00:45.874911
=========================================================================================
| End of training | test loss  4.58 | best_val_ppl    97.48 test ppl    97.89
=========================================================================================
final_out: /home/lr/yukun/common_corpus/data/50lm/ja Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) 97.47619598725198 97.88756873038005
1-15, 15-30, 30-45, 45-60, 60-75, 75-90, 90+
[153.06013144127496, 76.79578892743703, 59.28144588482067, 40.93673344294127, 35.724855251244925, 74.95342155655568, 0]
