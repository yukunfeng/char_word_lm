Namespace(batch_size=20, bptt=35, clip=0.25, combination=['1', '1', '0'], data='/home/lr/yukun/common_corpus/data/50lm/fi', device='cuda:0', dropout=0.5, emsize=650, epochs=40, input_freq=1, log_interval=200, lr=20, max_gram_n=3, model='LSTM', nhid=650, nlayers=2, note='Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2)', onnx_export='', save='char-word.en.model', seed=1111, tied=False, use_bilstm=True, weights=[1.0, 1.0, 0.0], word_out_num=1)
max length of word:35
n value in n-gram: 3
/home/lr/yukun/common_corpus/data/50lm/fi Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) total param_num: 178.411M
/home/lr/yukun/common_corpus/data/50lm/fi Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) decoder vocab size: 115582
/home/lr/yukun/common_corpus/data/50lm/fi Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) encoder vocab size: 115582
/home/lr/yukun/common_corpus/data/50lm/fi Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) ngram vocab size: 21002
| end of epoch   1 | time: 102.35s | valid loss  7.92 | valid ppl  2760.82 lr:20.00
| end of epoch   2 | time: 105.05s | valid loss  7.61 | valid ppl  2020.68 lr:20.00
| end of epoch   3 | time: 104.64s | valid loss  7.46 | valid ppl  1728.55 lr:20.00
| end of epoch   4 | time: 105.51s | valid loss  7.36 | valid ppl  1576.81 lr:20.00
| end of epoch   5 | time: 104.93s | valid loss  7.33 | valid ppl  1526.58 lr:20.00
| end of epoch   6 | time: 104.76s | valid loss  7.33 | valid ppl  1518.86 lr:20.00
| end of epoch   7 | time: 104.89s | valid loss  7.35 | valid ppl  1551.13 lr:20.00
| end of epoch   8 | time: 105.40s | valid loss  7.30 | valid ppl  1486.73 lr: 5.00
| end of epoch   9 | time: 104.96s | valid loss  7.31 | valid ppl  1501.26 lr: 5.00
| end of epoch  10 | time: 105.34s | valid loss  7.29 | valid ppl  1472.41 lr: 1.25
| end of epoch  11 | time: 105.31s | valid loss  7.30 | valid ppl  1480.02 lr: 1.25
| end of epoch  12 | time: 105.19s | valid loss  7.29 | valid ppl  1462.33 lr: 0.31
| end of epoch  13 | time: 105.85s | valid loss  7.29 | valid ppl  1460.78 lr: 0.31
| end of epoch  14 | time: 105.29s | valid loss  7.28 | valid ppl  1458.08 lr: 0.31
| end of epoch  15 | time: 105.32s | valid loss  7.29 | valid ppl  1458.28 lr: 0.31
| end of epoch  16 | time: 105.20s | valid loss  7.27 | valid ppl  1442.97 lr: 0.08
| end of epoch  17 | time: 105.23s | valid loss  7.27 | valid ppl  1439.26 lr: 0.08
| end of epoch  18 | time: 104.11s | valid loss  7.27 | valid ppl  1439.22 lr: 0.08
| end of epoch  19 | time: 104.25s | valid loss  7.27 | valid ppl  1440.27 lr: 0.08
all training time elapsed: 0:33:13.581363
training time per epoch: 0:00:49.839534
=========================================================================================
| End of training | test loss  7.36 | best_val_ppl  1439.22 test ppl  1577.65
=========================================================================================
final_out: /home/lr/yukun/common_corpus/data/50lm/fi Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) 1439.220410804766 1577.6451126272382
1-15, 15-30, 30-45, 45-60, 60-75, 75-90, 90+
[2041.6437162807072, 1939.3366510543149, 2655.679095574031, 2011.2728049894915, 1158.1567133379094, 929.3381408221327, 0]
