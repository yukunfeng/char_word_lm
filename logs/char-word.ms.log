Namespace(batch_size=20, bptt=35, clip=0.25, combination=['1', '1', '0'], data='/home/lr/yukun/common_corpus/data/50lm/ms', device='cuda:0', dropout=0.5, emsize=650, epochs=40, input_freq=1, log_interval=200, lr=20, max_gram_n=3, model='LSTM', nhid=650, nlayers=2, note='Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2)', onnx_export='', save='char-word.en.model', seed=1111, tied=False, use_bilstm=True, weights=[1.0, 1.0, 0.0], word_out_num=1)
max length of word:37
n value in n-gram: 3
/home/lr/yukun/common_corpus/data/50lm/ms Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) total param_num: 93.442M
/home/lr/yukun/common_corpus/data/50lm/ms Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) decoder vocab size: 49395
/home/lr/yukun/common_corpus/data/50lm/ms Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) encoder vocab size: 49395
/home/lr/yukun/common_corpus/data/50lm/ms Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) ngram vocab size: 22756
| end of epoch   1 | time: 75.98s | valid loss  6.78 | valid ppl   877.34 lr:20.00
| end of epoch   2 | time: 77.17s | valid loss  6.43 | valid ppl   622.60 lr:20.00
| end of epoch   3 | time: 77.32s | valid loss  6.23 | valid ppl   508.91 lr:20.00
| end of epoch   4 | time: 77.31s | valid loss  6.11 | valid ppl   451.02 lr:20.00
| end of epoch   5 | time: 77.31s | valid loss  6.04 | valid ppl   417.94 lr:20.00
| end of epoch   6 | time: 77.37s | valid loss  5.96 | valid ppl   386.61 lr:20.00
| end of epoch   7 | time: 77.35s | valid loss  5.95 | valid ppl   383.68 lr:20.00
| end of epoch   8 | time: 77.26s | valid loss  5.93 | valid ppl   375.67 lr:20.00
| end of epoch   9 | time: 77.21s | valid loss  5.92 | valid ppl   371.13 lr:20.00
| end of epoch  10 | time: 77.36s | valid loss  5.90 | valid ppl   364.08 lr:20.00
| end of epoch  11 | time: 77.31s | valid loss  5.90 | valid ppl   364.39 lr:20.00
| end of epoch  12 | time: 77.28s | valid loss  5.86 | valid ppl   350.35 lr: 5.00
| end of epoch  13 | time: 77.31s | valid loss  5.85 | valid ppl   347.47 lr: 5.00
| end of epoch  14 | time: 77.33s | valid loss  5.85 | valid ppl   348.82 lr: 5.00
| end of epoch  15 | time: 77.29s | valid loss  5.83 | valid ppl   338.71 lr: 1.25
| end of epoch  16 | time: 77.26s | valid loss  5.82 | valid ppl   337.00 lr: 1.25
| end of epoch  17 | time: 77.55s | valid loss  5.82 | valid ppl   336.02 lr: 1.25
| end of epoch  18 | time: 77.67s | valid loss  5.82 | valid ppl   336.65 lr: 1.25
| end of epoch  19 | time: 77.88s | valid loss  5.80 | valid ppl   331.45 lr: 0.31
| end of epoch  20 | time: 77.69s | valid loss  5.80 | valid ppl   331.42 lr: 0.31
| end of epoch  21 | time: 77.61s | valid loss  5.80 | valid ppl   331.38 lr: 0.31
| end of epoch  22 | time: 77.77s | valid loss  5.80 | valid ppl   331.14 lr: 0.31
| end of epoch  23 | time: 77.68s | valid loss  5.80 | valid ppl   331.12 lr: 0.31
| end of epoch  24 | time: 77.57s | valid loss  5.80 | valid ppl   331.86 lr: 0.31
| end of epoch  25 | time: 77.65s | valid loss  5.80 | valid ppl   331.00 lr: 0.08
| end of epoch  26 | time: 77.51s | valid loss  5.80 | valid ppl   330.68 lr: 0.08
| end of epoch  27 | time: 77.64s | valid loss  5.80 | valid ppl   330.44 lr: 0.08
| end of epoch  28 | time: 77.61s | valid loss  5.80 | valid ppl   330.14 lr: 0.08
| end of epoch  29 | time: 77.46s | valid loss  5.80 | valid ppl   330.01 lr: 0.08
| end of epoch  30 | time: 77.43s | valid loss  5.80 | valid ppl   329.99 lr: 0.08
| end of epoch  31 | time: 77.49s | valid loss  5.80 | valid ppl   329.94 lr: 0.08
| end of epoch  32 | time: 77.38s | valid loss  5.80 | valid ppl   329.99 lr: 0.08
all training time elapsed: 0:41:17.026405
training time per epoch: 0:01:01.925660
=========================================================================================
| End of training | test loss  6.05 | best_val_ppl   329.94 test ppl   422.67
=========================================================================================
final_out: /home/lr/yukun/common_corpus/data/50lm/ms Char-BiLSTM-add-Word-LSTM-Word(g= 0.5,n= 2) 329.9410205143636 422.67207280083744
1-15, 15-30, 30-45, 45-60, 60-75, 75-90, 90+
[535.6843119099694, 508.26201164612036, 348.34513652525123, 384.41625380646826, 397.7829882606997, 347.10605103566576, 0]
