Namespace(batch_size=20, bptt=35, clip=0.25, combination=['0', '1', '0'], data='/home/lr/yukun/common_corpus/data/50lm/pt', device='cuda:0', dropout=0.5, emsize=650, epochs=40, input_freq=1, log_interval=200, lr=20, max_gram_n=3, model='LSTM', nhid=650, nlayers=2, note='Char-BiLSTM-LSTM', onnx_export='', save='char.en.model', seed=1111, tied=False, use_bilstm=True, weights=[0.0, 1.0, 0.0], word_out_num=1)
max length of word:29
n value in n-gram: 3
/home/lr/yukun/common_corpus/data/50lm/pt Char-BiLSTM-LSTM total param_num: 64.848M
/home/lr/yukun/common_corpus/data/50lm/pt Char-BiLSTM-LSTM decoder vocab size: 56180
/home/lr/yukun/common_corpus/data/50lm/pt Char-BiLSTM-LSTM ngram vocab size: 21366
| end of epoch   1 | time: 79.29s | valid loss  6.20 | valid ppl   491.03 lr:20.00
| end of epoch   2 | time: 81.58s | valid loss  5.81 | valid ppl   332.35 lr:20.00
| end of epoch   3 | time: 81.78s | valid loss  5.61 | valid ppl   274.18 lr:20.00
| end of epoch   4 | time: 81.73s | valid loss  5.49 | valid ppl   243.31 lr:20.00
| end of epoch   5 | time: 81.85s | valid loss  5.43 | valid ppl   228.63 lr:20.00
| end of epoch   6 | time: 81.67s | valid loss  5.38 | valid ppl   216.67 lr:20.00
| end of epoch   7 | time: 81.68s | valid loss  5.34 | valid ppl   208.95 lr:20.00
| end of epoch   8 | time: 81.65s | valid loss  5.32 | valid ppl   204.83 lr:20.00
| end of epoch   9 | time: 81.64s | valid loss  5.30 | valid ppl   200.27 lr:20.00
| end of epoch  10 | time: 81.71s | valid loss  5.30 | valid ppl   200.42 lr:20.00
| end of epoch  11 | time: 81.53s | valid loss  5.23 | valid ppl   187.35 lr: 5.00
| end of epoch  12 | time: 81.74s | valid loss  5.22 | valid ppl   185.33 lr: 5.00
| end of epoch  13 | time: 81.52s | valid loss  5.22 | valid ppl   185.77 lr: 5.00
| end of epoch  14 | time: 81.74s | valid loss  5.20 | valid ppl   181.78 lr: 1.25
| end of epoch  15 | time: 81.70s | valid loss  5.20 | valid ppl   181.52 lr: 1.25
| end of epoch  16 | time: 81.70s | valid loss  5.20 | valid ppl   181.37 lr: 1.25
| end of epoch  17 | time: 81.66s | valid loss  5.20 | valid ppl   181.41 lr: 1.25
| end of epoch  18 | time: 81.58s | valid loss  5.19 | valid ppl   179.92 lr: 0.31
| end of epoch  19 | time: 81.79s | valid loss  5.19 | valid ppl   179.68 lr: 0.31
| end of epoch  20 | time: 81.61s | valid loss  5.19 | valid ppl   179.76 lr: 0.31
| end of epoch  21 | time: 81.77s | valid loss  5.19 | valid ppl   178.95 lr: 0.08
| end of epoch  22 | time: 81.66s | valid loss  5.19 | valid ppl   178.82 lr: 0.08
| end of epoch  23 | time: 81.70s | valid loss  5.19 | valid ppl   178.76 lr: 0.08
| end of epoch  24 | time: 81.56s | valid loss  5.19 | valid ppl   178.69 lr: 0.08
| end of epoch  25 | time: 81.60s | valid loss  5.19 | valid ppl   178.61 lr: 0.08
| end of epoch  26 | time: 81.71s | valid loss  5.19 | valid ppl   178.65 lr: 0.08
all training time elapsed: 0:35:21.174403
training time per epoch: 0:00:53.029360
=========================================================================================
| End of training | test loss  5.18 | best_val_ppl   178.61 test ppl   177.87
=========================================================================================
final_out: /home/lr/yukun/common_corpus/data/50lm/pt Char-BiLSTM-LSTM 178.6109075892065 177.86948293139892
1-15, 15-30, 30-45, 45-60, 60-75, 75-90, 90+
[94.4420583609736, 98.11934085733564, 88.61271354333851, 84.69498547023774, 105.62463239393733, 235.66906872678268, 0]
