Namespace(batch_size=20, bptt=35, clip=0.25, combination=['1', '0', '0'], data='/home/lr/yukun/common_corpus/data/50lm/cs', device='cuda:0', dropout=0.5, emsize=650, epochs=40, input_freq=1, log_interval=200, lr=20, max_gram_n=3, model='LSTM', nhid=650, nlayers=2, note='Word-LSTM', onnx_export='', save='word.en.model', seed=1111, tied=False, use_bilstm=True, weights=[1.0, 0.0, 0.0], word_out_num=1)
max length of word:35
n value in n-gram: 3
/home/lr/yukun/common_corpus/data/50lm/cs Word-LSTM total param_num: 127.304M
/home/lr/yukun/common_corpus/data/50lm/cs Word-LSTM decoder vocab size: 86793
/home/lr/yukun/common_corpus/data/50lm/cs Word-LSTM encoder vocab size: 86793
| end of epoch   1 | time: 54.85s | valid loss  7.55 | valid ppl  1904.06 lr:20.00
| end of epoch   2 | time: 56.34s | valid loss  7.27 | valid ppl  1436.10 lr:20.00
| end of epoch   3 | time: 57.19s | valid loss  7.11 | valid ppl  1226.78 lr:20.00
| end of epoch   4 | time: 56.99s | valid loss  7.03 | valid ppl  1126.00 lr:20.00
| end of epoch   5 | time: 57.30s | valid loss  6.96 | valid ppl  1049.42 lr:20.00
| end of epoch   6 | time: 57.46s | valid loss  6.94 | valid ppl  1035.74 lr:20.00
| end of epoch   7 | time: 57.06s | valid loss  6.93 | valid ppl  1026.17 lr:20.00
| end of epoch   8 | time: 57.36s | valid loss  6.95 | valid ppl  1046.34 lr:20.00
| end of epoch   9 | time: 57.12s | valid loss  6.99 | valid ppl  1082.22 lr: 5.00
| end of epoch  10 | time: 57.35s | valid loss  7.00 | valid ppl  1094.40 lr: 1.25
| end of epoch  11 | time: 56.86s | valid loss  6.97 | valid ppl  1064.67 lr: 0.31
| end of epoch  12 | time: 57.26s | valid loss  6.96 | valid ppl  1052.76 lr: 0.08
all training time elapsed: 0:11:23.157210
training time per epoch: 0:00:17.078930
=========================================================================================
| End of training | test loss  7.23 | best_val_ppl  1026.17 test ppl  1373.82
=========================================================================================
final_out: /home/lr/yukun/common_corpus/data/50lm/cs Word-LSTM 1026.1717032311608 1373.8173674662637
1-15, 15-30, 30-45, 45-60, 60-75, 75-90, 90+
[2273.152341748039, 1154.1328313422994, 1106.3578023033185, 1288.6104324981854, 764.6820196461899, 867.878535888908, 0]
