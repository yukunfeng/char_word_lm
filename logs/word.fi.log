Namespace(batch_size=20, bptt=35, clip=0.25, combination=['1', '0', '0'], data='/home/lr/yukun/common_corpus/data/50lm/fi', device='cuda:0', dropout=0.5, emsize=650, epochs=40, input_freq=1, log_interval=200, lr=20, max_gram_n=3, model='LSTM', nhid=650, nlayers=2, note='Word-LSTM', onnx_export='', save='word.en.model', seed=1111, tied=False, use_bilstm=True, weights=[1.0, 0.0, 0.0], word_out_num=1)
max length of word:35
n value in n-gram: 3
/home/lr/yukun/common_corpus/data/50lm/fi Word-LSTM total param_num: 164.759M
/home/lr/yukun/common_corpus/data/50lm/fi Word-LSTM decoder vocab size: 115582
/home/lr/yukun/common_corpus/data/50lm/fi Word-LSTM encoder vocab size: 115582
| end of epoch   1 | time: 62.44s | valid loss  7.99 | valid ppl  2944.81 lr:20.00
| end of epoch   2 | time: 64.96s | valid loss  7.73 | valid ppl  2266.74 lr:20.00
| end of epoch   3 | time: 65.82s | valid loss  7.62 | valid ppl  2034.20 lr:20.00
| end of epoch   4 | time: 65.81s | valid loss  7.58 | valid ppl  1961.41 lr:20.00
| end of epoch   5 | time: 65.86s | valid loss  7.62 | valid ppl  2043.28 lr:20.00
| end of epoch   6 | time: 65.77s | valid loss  7.66 | valid ppl  2115.53 lr: 5.00
| end of epoch   7 | time: 65.90s | valid loss  7.64 | valid ppl  2070.99 lr: 1.25
| end of epoch   8 | time: 65.91s | valid loss  7.62 | valid ppl  2028.82 lr: 0.31
| end of epoch   9 | time: 65.96s | valid loss  7.60 | valid ppl  2004.74 lr: 0.08
all training time elapsed: 0:09:48.422508
training time per epoch: 0:00:14.710563
=========================================================================================
| End of training | test loss  7.68 | best_val_ppl  1961.41 test ppl  2169.07
=========================================================================================
final_out: /home/lr/yukun/common_corpus/data/50lm/fi Word-LSTM 1961.410710612259 2169.0673851336683
1-15, 15-30, 30-45, 45-60, 60-75, 75-90, 90+
[3667.3578622554305, 2643.025809724893, 3060.918105206041, 2326.0645817300388, 1386.997558238918, 1006.8028012865814, 0]
