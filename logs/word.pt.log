Namespace(batch_size=20, bptt=35, clip=0.25, combination=['1', '0', '0'], data='/home/lr/yukun/common_corpus/data/50lm/pt', device='cuda:0', dropout=0.5, emsize=650, epochs=40, input_freq=1, log_interval=200, lr=20, max_gram_n=3, model='LSTM', nhid=650, nlayers=2, note='Word-LSTM', onnx_export='', save='word.en.model', seed=1111, tied=False, use_bilstm=True, weights=[1.0, 0.0, 0.0], word_out_num=1)
max length of word:29
n value in n-gram: 3
/home/lr/yukun/common_corpus/data/50lm/pt Word-LSTM total param_num: 87.477M
/home/lr/yukun/common_corpus/data/50lm/pt Word-LSTM decoder vocab size: 56180
/home/lr/yukun/common_corpus/data/50lm/pt Word-LSTM encoder vocab size: 56180
| end of epoch   1 | time: 45.91s | valid loss  6.10 | valid ppl   446.96 lr:20.00
| end of epoch   2 | time: 47.58s | valid loss  5.74 | valid ppl   311.70 lr:20.00
| end of epoch   3 | time: 48.12s | valid loss  5.56 | valid ppl   260.55 lr:20.00
| end of epoch   4 | time: 48.17s | valid loss  5.47 | valid ppl   236.68 lr:20.00
| end of epoch   5 | time: 48.16s | valid loss  5.41 | valid ppl   223.53 lr:20.00
| end of epoch   6 | time: 48.13s | valid loss  5.39 | valid ppl   219.09 lr:20.00
| end of epoch   7 | time: 48.28s | valid loss  5.36 | valid ppl   213.35 lr:20.00
| end of epoch   8 | time: 48.22s | valid loss  5.36 | valid ppl   211.86 lr:20.00
| end of epoch   9 | time: 48.10s | valid loss  5.37 | valid ppl   213.95 lr:20.00
| end of epoch  10 | time: 48.20s | valid loss  5.35 | valid ppl   210.92 lr: 5.00
| end of epoch  11 | time: 48.16s | valid loss  5.35 | valid ppl   210.98 lr: 5.00
| end of epoch  12 | time: 48.13s | valid loss  5.34 | valid ppl   208.58 lr: 1.25
| end of epoch  13 | time: 48.24s | valid loss  5.34 | valid ppl   208.97 lr: 1.25
| end of epoch  14 | time: 48.17s | valid loss  5.33 | valid ppl   205.94 lr: 0.31
| end of epoch  15 | time: 48.29s | valid loss  5.33 | valid ppl   205.71 lr: 0.31
| end of epoch  16 | time: 48.09s | valid loss  5.33 | valid ppl   205.69 lr: 0.31
| end of epoch  17 | time: 48.20s | valid loss  5.33 | valid ppl   205.86 lr: 0.31
| end of epoch  18 | time: 48.10s | valid loss  5.32 | valid ppl   204.69 lr: 0.08
| end of epoch  19 | time: 48.22s | valid loss  5.32 | valid ppl   204.34 lr: 0.08
| end of epoch  20 | time: 48.15s | valid loss  5.32 | valid ppl   204.22 lr: 0.08
| end of epoch  21 | time: 48.16s | valid loss  5.32 | valid ppl   204.07 lr: 0.08
| end of epoch  22 | time: 48.14s | valid loss  5.32 | valid ppl   204.12 lr: 0.08
all training time elapsed: 0:17:36.952905
training time per epoch: 0:00:26.423823
=========================================================================================
| End of training | test loss  5.31 | best_val_ppl   204.07 test ppl   201.40
=========================================================================================
final_out: /home/lr/yukun/common_corpus/data/50lm/pt Word-LSTM 204.0731022614663 201.3984051038738
1-15, 15-30, 30-45, 45-60, 60-75, 75-90, 90+
[157.6614601630464, 106.71108129800668, 99.07495587686815, 83.29682957535879, 111.45539626709578, 238.40851980675518, 0]
